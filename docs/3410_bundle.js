(self.webpackChunk=self.webpackChunk||[]).push([[3410],{3410:(e,t,r)=>{"use strict";function a(e,t,r){var a=e.createShader(t);return e.shaderSource(a,r),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(alert("An error occurred compiling the shaders: ".concat(e.getShaderInfoLog(a))),e.deleteShader(a),null)}function i(e,t,r,a,i){return(i=i||new Float32Array(16))[0]=t*e[0],i[1]=t*e[1],i[2]=t*e[2],i[3]=t*e[3],i[4]=r*e[4],i[5]=r*e[5],i[6]=r*e[6],i[7]=r*e[7],i[8]=a*e[8],i[9]=a*e[9],i[10]=a*e[10],i[11]=a*e[11],e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i}r.r(t),r.d(t,{renderImages:()=>n});var n=function(){var e=this.context;Object.values(this.$cameras).forEach((function(t){var r=t.getDicoElement("images");r=r.sort((function(e,t){return e.destination.z-t.destination.z}));var n=function(e,t,r){var i=a(e,e.VERTEX_SHADER,"attribute vec4 a_position;\nattribute vec2 a_texcoord;\n\nuniform mat4 u_matrix;\nuniform mat4 u_textureMatrix;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n   gl_Position = u_matrix * a_position;\n   v_texcoord = (u_textureMatrix * vec4(a_texcoord, 0, 1)).xy;\n}"),n=a(e,e.FRAGMENT_SHADER,"precision mediump float;\n\nvarying vec2 v_texcoord;\n\nuniform sampler2D u_texture;\n\nvoid main() {\n   gl_FragColor = texture2D(u_texture, v_texcoord);\n}"),o=e.createProgram();return e.attachShader(o,i),e.attachShader(o,n),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)?o:(alert("Unable to initialize the shader program: ".concat(e.getProgramInfoLog(o))),null)}(e);e.viewport(0,0,e.canvas.width,e.canvas.height),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW);var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW),e.useProgram(n),r.forEach((function(r){var a=r.destination,u=r.frame,E=r.opacity,_=r.source,A=t.visible(a.x*t.screen.scale(),a.y*t.screen.scale(),a.width*t.screen.scale(),a.height*t.screen.scale());if(E>0&&!0===A){var T=e.globalAlpha;e.globalAlpha=E;var l={destination:{x:t.screen.x()+a.x*t.screen.scale()-(t.position.x()*t.screen.scale()-t.screen.width()/2),y:t.screen.y()+a.y*t.screen.scale()-(t.position.y()*t.screen.scale()-t.screen.height()/2),width:a.width*t.screen.scale(),height:a.height*t.screen.scale()}},R={top:Math.min(0,l.destination.y-t.screen.y()),right:Math.max(0,l.destination.x+l.destination.width-(t.screen.x()+t.screen.width())),bottom:Math.max(0,l.destination.y+l.destination.height-(t.screen.y()+t.screen.height())),left:Math.min(0,l.destination.x-t.screen.x())};e.globalAlpha=T,function(e,t,r,a,n,s,d,u,E,_,A,T,l){var R,f=c.indexOf(n);R=-1!==f?h[f]:function(e,t){var r=e.createTexture(t);return h.push(r),c.push(t),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),o(t.width)&&o(t.height)&&(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D)),e.bindTexture(e.TEXTURE_2D,null),r}(e,n);var g=e.getAttribLocation(r,"a_position"),x=e.getAttribLocation(r,"a_texcoord"),m=e.getUniformLocation(r,"u_matrix"),v=e.getUniformLocation(r,"u_textureMatrix"),b=e.getUniformLocation(r,"u_texture");e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(g),e.vertexAttribPointer(g,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t),e.enableVertexAttribArray(x),e.vertexAttribPointer(x,2,e.FLOAT,!1,0,0);var U,p,w,S=(0,U=e.canvas.width,p=e.canvas.height,0,-1,1,(w=w||new Float32Array(16))[0]=2/(U-0),w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2/(0-p),w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=-1,w[11]=0,w[12]=(0+U)/(0-U),w[13]=(p+0)/(p-0),w[14]=-0,w[15]=1,w);S=i(S=function(e,t,r,a,i){i=i||new Float32Array(16);var n=e[0],o=e[1],h=e[2],c=e[3],s=e[4],d=e[5],u=e[6],E=e[7],_=e[8],A=e[9],T=e[10],l=e[11],R=e[12],f=e[13],g=e[14],x=e[15];return e!==i&&(i[0]=n,i[1]=o,i[2]=h,i[3]=c,i[4]=s,i[5]=d,i[6]=u,i[7]=E,i[8]=_,i[9]=A,i[10]=T,i[11]=l),i[12]=n*t+s*r+0*_+R,i[13]=o*t+d*r+0*A+f,i[14]=h*t+u*r+0*T+g,i[15]=c*t+E*r+0*l+x,i}(S,_,A),T,l,2),e.uniformMatrix4fv(m,!1,S);var F=function(e,t,r,a){return(a=a||new Float32Array(16))[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=e,a[13]=t,a[14]=0,a[15]=1,a}(s/n.width,d/n.height);F=i(F,u/n.width,E/n.height,1),e.uniformMatrix4fv(v,!1,F),e.uniform1i(b,0),e.bindTexture(e.TEXTURE_2D,R),e.activeTexture(e.TEXTURE0),e.drawArrays(e.TRIANGLES,0,6)}(e,d,n,s,_,u.x-R.left*(u.width/l.destination.width),u.y-R.top*(u.height/l.destination.height),u.width-R.right*(u.width/l.destination.width)-Math.abs(R.left*(u.width/l.destination.width)),u.height-R.bottom*(u.height/l.destination.height)-Math.abs(R.top*(u.height/l.destination.height)),l.destination.x-R.left,l.destination.y-R.top,l.destination.width-R.right-Math.abs(R.left),l.destination.height-R.bottom-Math.abs(R.top))}})),r=[]}))};function o(e){return e>0&&0==(e-1&e)}var h=[],c=[]}}]);
//# sourceMappingURL=3410_bundle.js.map